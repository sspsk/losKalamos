{% extends 'base.html' %}
{% block title %}Login{% endblock %}
{% block myscript %}

<script>
  $(document).ready(function(){
    $("#regionSelector").change(function(){
      $.getJSON($SCRIPT_ROOT + '/getareas',{region : $(this).val()},function(data){
          $("#areaSelector").empty();
          $("#areaSelector").append('<option selected disabled>Υποπεριοχή</option>');
        for(let i =0;i<data.length;i++){
          $("#areaSelector").append('<option>'+data[i][1]+'</option>');
        }
      });
      //kane get request me to $(this).val() kai append to html sto select kato
    });
  });
</script>
{% endblock %}
{% block content %}

<div class="container">


  <div class="row d-flex justify-content-center ">
    <h1>Δήμος Ωρωπού</h1>
  </div>
  <div class="row d-flex justify-content-center">
    <h2>Σύστημα διαχείρησης βλαβών</h2>
  </div>
  <div class="row " >
    <div class="col-5  bg-light rounded" id="indexCol">
    <form class="" method="post" action="{{ url_for('reports.report') }}">
         <div class="form-group">
          <p class="h4 mb-4 text-center" >Αναφορά βλάβης</p>
          </div>
           <div class="form-group">
          <select class="form-control"  name="type" >
            <option selected disabled>Είδος</option>
            <option>Ύδρευση</option>
            <option>Οδόστρωμα</option>
            <option>Ηλεκτροφωτισμός</option>
            <option>Καθαριότητα</option>
            <option>Άλλο</option>

          </select>
          </div>
           <div class="form-group">
             <select id="regionSelector" class="form-control"  name="region" >
               <option selected disabled>Κοινότητα</option>
               {% for region in regions %}
               <option>{{region['name']}}</option>
               {%endfor%}
             </select>
          </div>
          <div class="form-group">
            <select id="areaSelector" class="form-control"  name="area" >
              <option selected disabled>Περιοχή</option>
            </select>
         </div>
          <div class="form-group">
              <input type="text" id="defaultLoginFormUsername" class="form-control mb-4" placeholder="Διευθυνση βλαβης" name="address" required>
          </div>
           <div class="form-group">
          <input type="text" id="defaultLoginFormUsername" class="form-control mb-4" placeholder="Περιγραφη βλαβης" name="description" required>
          </div>
          <div class="form-group">
         <input type="text" id="defaultLoginFormUsername" class="form-control mb-4" placeholder="Ονοματεπωνυμο(οχι απαραίτητο-επιθυμητο)" name="contact_name" >
         </div>
         <div class="form-group">
        <input type="text" id="defaultLoginFormUsername" class="form-control mb-4" placeholder="Τηλεφωνο επικοινωνιας(οχι απαραίτητο-επιθυμητο)" name="contact_phone" >
        </div>
        <div class="form-group">
           <button class="btn btn-info btn-block my-4" type="submit">Αναφορά</button>
        </div>



    </form>
  </div>
  {% if g.user %}
  <div class="col-5 align-self-center bg-light rounded" id="indexCol">

  <form class="" method="get" action="{{url_for('reports.entries')}}">
    <div class="form-group">
      <p class="h4 mb-4 text-center">Σύνδεση</p>
      </div>
      <div class="form-group">
       <button class="btn btn-info btn-block my-4" type="submit">Συνέχεια ως{{g.user['username']}}</button>
      </div>
  </form>
  <form class="" method="get" action="{{url_for('auth.logout')}}">
      <div class="form-group">
       <button class="btn btn-info btn-block my-4" type="submit">Αποσύνδεση</button>
      </div>
  </form>
  </div>
  {% else %}
  <div class="col-5 align-self-center bg-light rounded" id="indexCol">
  <form class="" method="post">
      <div class="form-group">
        <p class="h4 mb-4 text-center">Σύνδεση</p>
        </div>
        <div class="form-group">
            <input type="text" id="defaultLoginFormUsername" class="form-control mb-4" placeholder="Ονομα χρήστη" name="username" required>
            </div>
        <div class="form-group">
        <input type="password" id="defaultLoginFormPassword" class="form-control mb-4" placeholder="Κωδικος προσβασης" name="password" required>
          </div>
        <div class="form-group">
       <button class="btn btn-info btn-block my-4" type="submit">Είσοδος</button>
         </div>
  </form>
  </div>
  {% endif %}
  </div>
  {% for message in get_flashed_messages() %}
      <div class="alert alert-info">{{ message }}</div>
  {% endfor %}

</div>



{% endblock %}
